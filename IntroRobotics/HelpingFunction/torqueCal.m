function T = torqueCal(q,Fn)
    %% Parameter
    l = [250.5 500 100 507.2 0 230]';
    
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    q6 = q(6);
    
    l1 = l(1);
    l2 = l(2);
    l3 = l(3);
    l4 = l(4);
    l5 = l(5);
    l6 = l(6);
    
    g = 9.81;
    F = [       0,      0,       0,       0,       0,       0 ;
                0,      0,       0,       0,       0,       0 ;
          -7.37*g, -2.4*g, -1.49*g,  1.77*g, -0.86*g,  -0.5*g ]; %N
    CM = [   -0.07,     0.41,    -12.31,      0.14,        0,       0.56 ;
            -82.54,  -219.17,      0.01,    214.07,     4.36,       0.84 ;
             39.81,      6.7,      9.33,     -4.18,   -58.30,     -58.56 ]; %%mm
    
    %% ManipulatorJacobian in each links
    %{
    J_1 = [ (l4*cos(q1 - q2 - q3 + pi/3))/2 + (l4*sin(q1 + q2 + q3 + pi/6))/2 + (l6*cos(q1 - q2 - q3 + pi/3)*sin(q5 + pi/3))/2 - l2*cos(q1)*sin(q2) + l5*cos(q4)*sin(q1) + (l6*sin(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*sin(q1)*sin(q4) - (l5*cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - (l5*cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 + (l6*cos(q1)*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q3))/2 + (l6*cos(q1)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q2))/2 + (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 - (3^(1/2)*l5*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*cos(q5 + pi/3)*sin(q2)*sin(q3))/2 - 500, 0, 0, 0, 0, 0 ;
            (l4*cos(q2 - q1 + q3 + pi/6))/2 - (l4*cos(q1 + q2 + q3 + pi/6))/2 - l5*cos(q1)*cos(q4) - (l6*cos(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 - l2*sin(q1)*sin(q2) + (l6*cos(q2 - q1 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l6*cos(q1)*cos(q5 + pi/3)*sin(q4) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) - (l5*cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (l5*cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 + (l6*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q3))/2 + (l6*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2))/2 + (3^(1/2)*l5*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (3^(1/2)*l5*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1))/2 + (3^(1/2)*l6*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2)*sin(q3))/2 + 200, 0, 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, 0, 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, 0, 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, 0, 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1, 0, 0, 0, 0, 0 ];
    J_2 = [ (l4*cos(q1 - q2 - q3 + pi/3))/2 + (l4*sin(q1 + q2 + q3 + pi/6))/2 + (l6*cos(q1 - q2 - q3 + pi/3)*sin(q5 + pi/3))/2 - l2*cos(q1)*sin(q2) + l5*cos(q4)*sin(q1) + (l6*sin(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*sin(q1)*sin(q4) - (l5*cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - (l5*cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 + (l6*cos(q1)*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q3))/2 + (l6*cos(q1)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q2))/2 + (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 - (3^(1/2)*l5*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*cos(q5 + pi/3)*sin(q2)*sin(q3))/2 - 500,                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), 0, 0, 0, 0 ;
            (l4*cos(q2 - q1 + q3 + pi/6))/2 - (l4*cos(q1 + q2 + q3 + pi/6))/2 - l5*cos(q1)*cos(q4) - (l6*cos(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 - l2*sin(q1)*sin(q2) + (l6*cos(q2 - q1 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l6*cos(q1)*cos(q5 + pi/3)*sin(q4) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) - (l5*cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (l5*cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 + (l6*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q3))/2 + (l6*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2))/2 + (3^(1/2)*l5*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (3^(1/2)*l5*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1))/2 + (3^(1/2)*l6*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2)*sin(q3))/2 + 200,                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -cos(q1), 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -sin(q1), 0, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0, 0, 0, 0, 0 ];
    J_3 = [ (l4*cos(q1 - q2 - q3 + pi/3))/2 + (l4*sin(q1 + q2 + q3 + pi/6))/2 + (l6*cos(q1 - q2 - q3 + pi/3)*sin(q5 + pi/3))/2 - l2*cos(q1)*sin(q2) + l5*cos(q4)*sin(q1) + (l6*sin(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*sin(q1)*sin(q4) - (l5*cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - (l5*cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 + (l6*cos(q1)*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q3))/2 + (l6*cos(q1)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q2))/2 + (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 - (3^(1/2)*l5*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*cos(q5 + pi/3)*sin(q2)*sin(q3))/2 - 500,                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), 0, 0, 0 ;
            (l4*cos(q2 - q1 + q3 + pi/6))/2 - (l4*cos(q1 + q2 + q3 + pi/6))/2 - l5*cos(q1)*cos(q4) - (l6*cos(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 - l2*sin(q1)*sin(q2) + (l6*cos(q2 - q1 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l6*cos(q1)*cos(q5 + pi/3)*sin(q4) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) - (l5*cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (l5*cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 + (l6*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q3))/2 + (l6*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2))/2 + (3^(1/2)*l5*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (3^(1/2)*l5*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1))/2 + (3^(1/2)*l6*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2)*sin(q3))/2 + 200,                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -cos(q1), 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -sin(q1), 0, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0, 0, 0, 0 ];
    J_4 = [ (l4*cos(q1 - q2 - q3 + pi/3))/2 + (l4*sin(q1 + q2 + q3 + pi/6))/2 + (l6*cos(q1 - q2 - q3 + pi/3)*sin(q5 + pi/3))/2 - l2*cos(q1)*sin(q2) + l5*cos(q4)*sin(q1) + (l6*sin(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*sin(q1)*sin(q4) - (l5*cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - (l5*cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 + (l6*cos(q1)*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q3))/2 + (l6*cos(q1)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q2))/2 + (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 - (3^(1/2)*l5*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*cos(q5 + pi/3)*sin(q2)*sin(q3))/2 - 500,                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*cos(q1)*sin(q4) - (l6*cos(q1)*cos(q4)*cos(q5))/2 - (l5*cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - (l5*cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*sin(q5))/2 - (3*l6*cos(q2)*cos(q3)*sin(q1)*sin(q4)*sin(q5))/4 - (l6*cos(q2)*cos(q5)*sin(q1)*sin(q3)*sin(q4))/4 - (l6*cos(q3)*cos(q5)*sin(q1)*sin(q2)*sin(q4))/4 + (3*l6*sin(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l5*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 - (3^(1/2)*l5*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2 + (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q5)*sin(q1)*sin(q4))/4 + (3^(1/2)*l6*cos(q2)*sin(q1)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q3)*sin(q1)*sin(q2)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q5)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/4, 0, 0 ;
            (l4*cos(q2 - q1 + q3 + pi/6))/2 - (l4*cos(q1 + q2 + q3 + pi/6))/2 - l5*cos(q1)*cos(q4) - (l6*cos(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 - l2*sin(q1)*sin(q2) + (l6*cos(q2 - q1 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l6*cos(q1)*cos(q5 + pi/3)*sin(q4) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) - (l5*cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (l5*cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 + (l6*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q3))/2 + (l6*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2))/2 + (3^(1/2)*l5*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (3^(1/2)*l5*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1))/2 + (3^(1/2)*l6*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2)*sin(q3))/2 + 200,                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*sin(q1)*sin(q4) - (l6*cos(q4)*cos(q5)*sin(q1))/2 + (l5*cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (l5*cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 + (3^(1/2)*l6*cos(q4)*sin(q1)*sin(q5))/2 + (3*l6*cos(q1)*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (l6*cos(q1)*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (l6*cos(q1)*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 - (3*l6*cos(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*l5*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3^(1/2)*l6*cos(q1)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q1)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q1)*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,                                                                                                                                                                                                (l5*cos(q2)*cos(q3)*cos(q4))/2 - (l5*cos(q4)*sin(q2)*sin(q3))/2 + (l6*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3*l6*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3*l6*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 - (l6*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4 + (3^(1/2)*l5*cos(q2)*cos(q4)*sin(q3))/2 + (3^(1/2)*l5*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (3^(1/2)*l6*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 + (3^(1/2)*l6*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 + q2 + q3 + pi/6)/2 - cos(q2 - q1 + q3 + pi/6)/2, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2, 0, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cos(q2 + q3 + pi/6), 0, 0 ];
    J_5 = [ (l4*cos(q1 - q2 - q3 + pi/3))/2 + (l4*sin(q1 + q2 + q3 + pi/6))/2 + (l6*cos(q1 - q2 - q3 + pi/3)*sin(q5 + pi/3))/2 - l2*cos(q1)*sin(q2) + l5*cos(q4)*sin(q1) + (l6*sin(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*sin(q1)*sin(q4) - (l5*cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - (l5*cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 + (l6*cos(q1)*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q3))/2 + (l6*cos(q1)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q2))/2 + (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 - (3^(1/2)*l5*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*cos(q5 + pi/3)*sin(q2)*sin(q3))/2 - 500,                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*cos(q1)*sin(q4) - (l6*cos(q1)*cos(q4)*cos(q5))/2 - (l5*cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - (l5*cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*sin(q5))/2 - (3*l6*cos(q2)*cos(q3)*sin(q1)*sin(q4)*sin(q5))/4 - (l6*cos(q2)*cos(q5)*sin(q1)*sin(q3)*sin(q4))/4 - (l6*cos(q3)*cos(q5)*sin(q1)*sin(q2)*sin(q4))/4 + (3*l6*sin(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l5*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 - (3^(1/2)*l5*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2 + (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q5)*sin(q1)*sin(q4))/4 + (3^(1/2)*l6*cos(q2)*sin(q1)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q3)*sin(q1)*sin(q2)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q5)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/4, l6*cos(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q2)*cos(q4)*cos(q3 + pi/6)*sin(q1)*sin(q5 + pi/3) - l6*cos(q4)*sin(q1)*sin(q2)*sin(q5 + pi/3)*sin(q3 + pi/6) + l6*cos(q2)*cos(q4)^2*cos(q5 + pi/3)*sin(q1)*sin(q3 + pi/6) + l6*cos(q4)^2*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q1)*sin(q2) + l6*cos(q2)*cos(q5 + pi/3)*sin(q1)*sin(q4)^2*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q1)*sin(q2)*sin(q4)^2 + l6*cos(q1)*cos(q2)^2*cos(q3 + pi/6)^2*sin(q4)*sin(q5 + pi/3) + l6*cos(q1)*cos(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q1)*cos(q3 + pi/6)^2*sin(q2)^2*sin(q4)*sin(q5 + pi/3), 0 ;
            (l4*cos(q2 - q1 + q3 + pi/6))/2 - (l4*cos(q1 + q2 + q3 + pi/6))/2 - l5*cos(q1)*cos(q4) - (l6*cos(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 - l2*sin(q1)*sin(q2) + (l6*cos(q2 - q1 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l6*cos(q1)*cos(q5 + pi/3)*sin(q4) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) - (l5*cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (l5*cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 + (l6*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q3))/2 + (l6*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2))/2 + (3^(1/2)*l5*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (3^(1/2)*l5*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1))/2 + (3^(1/2)*l6*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2)*sin(q3))/2 + 200,                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*sin(q1)*sin(q4) - (l6*cos(q4)*cos(q5)*sin(q1))/2 + (l5*cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (l5*cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 + (3^(1/2)*l6*cos(q4)*sin(q1)*sin(q5))/2 + (3*l6*cos(q1)*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (l6*cos(q1)*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (l6*cos(q1)*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 - (3*l6*cos(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*l5*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3^(1/2)*l6*cos(q1)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q1)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q1)*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4, l6*cos(q2)^2*sin(q1)*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q3 + pi/6)^2*sin(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3) + l6*sin(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 - l6*cos(q1)*cos(q2)*cos(q4)*cos(q3 + pi/6)*sin(q5 + pi/3) + l6*cos(q1)*cos(q4)*sin(q2)*sin(q5 + pi/3)*sin(q3 + pi/6) - l6*cos(q1)*cos(q2)*cos(q4)^2*cos(q5 + pi/3)*sin(q3 + pi/6) - l6*cos(q1)*cos(q4)^2*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q2) - l6*cos(q1)*cos(q2)*cos(q5 + pi/3)*sin(q4)^2*sin(q3 + pi/6) - l6*cos(q1)*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q2)*sin(q4)^2 + l6*cos(q2)^2*cos(q3 + pi/6)^2*sin(q1)*sin(q4)*sin(q5 + pi/3), 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,                                                                                                                                                                                                (l5*cos(q2)*cos(q3)*cos(q4))/2 - (l5*cos(q4)*sin(q2)*sin(q3))/2 + (l6*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3*l6*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3*l6*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 - (l6*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4 + (3^(1/2)*l5*cos(q2)*cos(q4)*sin(q3))/2 + (3^(1/2)*l5*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (3^(1/2)*l6*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 + (3^(1/2)*l6*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4,                                                                                                                                                                                                                                                                                                                                                                                                                                                 (l6*(4*sin(q2 + q3 + q5) - 4*sin(q2 + q3 - q5 + pi/3) + 2*sin(q2 + q3 + q4 + q5) + 2*sin(q2 + q3 + q4 - q5 + pi/3) + 2*cos(q4 - q3 - q2 + q5 + pi/6) + 2*sin(q2 + q3 - q4 + q5)))/8, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 + q2 + q3 + pi/6)/2 - cos(q2 - q1 + q3 + pi/6)/2,                                                                                                                                                                                                                                                                                                                                                                                                                                             (3^(1/2)*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 - cos(q1)*cos(q4) - (3^(1/2)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2,                                                                                                                                                                                                                                                                                                                                                                                                                                             (cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - cos(q4)*sin(q1) + (cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 + (3^(1/2)*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2, 0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cos(q2 + q3 + pi/6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sin(q2 + q3 + pi/6)*sin(q4), 0 ];
    J_6 = [ (l4*cos(q1 - q2 - q3 + pi/3))/2 + (l4*sin(q1 + q2 + q3 + pi/6))/2 + (l6*cos(q1 - q2 - q3 + pi/3)*sin(q5 + pi/3))/2 - l2*cos(q1)*sin(q2) + l5*cos(q4)*sin(q1) + (l6*sin(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*sin(q1)*sin(q4) - (l5*cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - (l5*cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 + (l6*cos(q1)*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q3))/2 + (l6*cos(q1)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q2))/2 + (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 - (3^(1/2)*l5*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*cos(q5 + pi/3)*sin(q2)*sin(q3))/2 - 500,                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*cos(q1)*sin(q4) - (l6*cos(q1)*cos(q4)*cos(q5))/2 - (l5*cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - (l5*cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*sin(q5))/2 - (3*l6*cos(q2)*cos(q3)*sin(q1)*sin(q4)*sin(q5))/4 - (l6*cos(q2)*cos(q5)*sin(q1)*sin(q3)*sin(q4))/4 - (l6*cos(q3)*cos(q5)*sin(q1)*sin(q2)*sin(q4))/4 + (3*l6*sin(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l5*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 - (3^(1/2)*l5*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2 + (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q5)*sin(q1)*sin(q4))/4 + (3^(1/2)*l6*cos(q2)*sin(q1)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q3)*sin(q1)*sin(q2)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q5)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/4, l6*cos(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q2)*cos(q4)*cos(q3 + pi/6)*sin(q1)*sin(q5 + pi/3) - l6*cos(q4)*sin(q1)*sin(q2)*sin(q5 + pi/3)*sin(q3 + pi/6) + l6*cos(q2)*cos(q4)^2*cos(q5 + pi/3)*sin(q1)*sin(q3 + pi/6) + l6*cos(q4)^2*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q1)*sin(q2) + l6*cos(q2)*cos(q5 + pi/3)*sin(q1)*sin(q4)^2*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q1)*sin(q2)*sin(q4)^2 + l6*cos(q1)*cos(q2)^2*cos(q3 + pi/6)^2*sin(q4)*sin(q5 + pi/3) + l6*cos(q1)*cos(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q1)*cos(q3 + pi/6)^2*sin(q2)^2*sin(q4)*sin(q5 + pi/3),                                                                                                                                                                                                                                                                                     0 ;
            (l4*cos(q2 - q1 + q3 + pi/6))/2 - (l4*cos(q1 + q2 + q3 + pi/6))/2 - l5*cos(q1)*cos(q4) - (l6*cos(q1 + q2 + q3 + pi/6)*sin(q5 + pi/3))/2 - l2*sin(q1)*sin(q2) + (l6*cos(q2 - q1 + q3 + pi/6)*sin(q5 + pi/3))/2 + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l6*cos(q1)*cos(q5 + pi/3)*sin(q4) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) - (l5*cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (l5*cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 + (l6*cos(q2)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q3))/2 + (l6*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2))/2 + (3^(1/2)*l5*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (3^(1/2)*l5*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q4)*cos(q5 + pi/3)*sin(q1))/2 + (3^(1/2)*l6*cos(q4)*cos(q5 + pi/3)*sin(q1)*sin(q2)*sin(q3))/2 + 200,                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*sin(q1)*sin(q4) - (l6*cos(q4)*cos(q5)*sin(q1))/2 + (l5*cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (l5*cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 + (3^(1/2)*l6*cos(q4)*sin(q1)*sin(q5))/2 + (3*l6*cos(q1)*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (l6*cos(q1)*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (l6*cos(q1)*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 - (3*l6*cos(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*l5*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3^(1/2)*l6*cos(q1)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q1)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q1)*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4, l6*cos(q2)^2*sin(q1)*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q3 + pi/6)^2*sin(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3) + l6*sin(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 - l6*cos(q1)*cos(q2)*cos(q4)*cos(q3 + pi/6)*sin(q5 + pi/3) + l6*cos(q1)*cos(q4)*sin(q2)*sin(q5 + pi/3)*sin(q3 + pi/6) - l6*cos(q1)*cos(q2)*cos(q4)^2*cos(q5 + pi/3)*sin(q3 + pi/6) - l6*cos(q1)*cos(q4)^2*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q2) - l6*cos(q1)*cos(q2)*cos(q5 + pi/3)*sin(q4)^2*sin(q3 + pi/6) - l6*cos(q1)*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q2)*sin(q4)^2 + l6*cos(q2)^2*cos(q3 + pi/6)^2*sin(q1)*sin(q4)*sin(q5 + pi/3),                                                                                                                                                                                                                                                                                     0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,                                                                                                                                                                                                (l5*cos(q2)*cos(q3)*cos(q4))/2 - (l5*cos(q4)*sin(q2)*sin(q3))/2 + (l6*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3*l6*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3*l6*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 - (l6*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4 + (3^(1/2)*l5*cos(q2)*cos(q4)*sin(q3))/2 + (3^(1/2)*l5*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (3^(1/2)*l6*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 + (3^(1/2)*l6*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4,                                                                                                                                                                                                                                                                                                                                                                                                                                                 (l6*(4*sin(q2 + q3 + q5) - 4*sin(q2 + q3 - q5 + pi/3) + 2*sin(q2 + q3 + q4 + q5) + 2*sin(q2 + q3 + q4 - q5 + pi/3) + 2*cos(q4 - q3 - q2 + q5 + pi/6) + 2*sin(q2 + q3 - q4 + q5)))/8,                                                                                                                                                                                                                                                                                     0 ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 + q2 + q3 + pi/6)/2 - cos(q2 - q1 + q3 + pi/6)/2,                                                                                                                                                                                                                                                                                                                                                                                                                                             (3^(1/2)*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 - cos(q1)*cos(q4) - (3^(1/2)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2, - sin(q5 + pi/3)*(cos(q2 - q1 + q3 + pi/6)/2 - cos(q1 + q2 + q3 + pi/6)/2) - cos(q5 + pi/3)*((cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - cos(q1)*sin(q4) + (cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 - (3^(1/2)*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 + (3^(1/2)*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2) ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2,                                                                                                                                                                                                                                                                                                                                                                                                                                             (cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - cos(q4)*sin(q1) + (cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 + (3^(1/2)*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2,   cos(q5 + pi/3)*(sin(q1)*sin(q4) + (cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2) + sin(q5 + pi/3)*(cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2) ;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cos(q2 + q3 + pi/6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sin(q2 + q3 + pi/6)*sin(q4),                                                                                                                                                                                         cos(q2 + q3 + q5)/2 + cos(q2 + q3 - q5 + pi/3)/2 + sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3) ];
    %}
    
    J_1 = [ 0, 0, 0, 0, 0, 0;
            0, 0, 0, 0, 0, 0;
            0, 0, 0, 0, 0, 0;
            0, 0, 0, 0, 0, 0;
            0, 0, 0, 0, 0, 0;
            1, 0, 0, 0, 0, 0];

    J_2 = [ -l2*cos(q1)*sin(q2), -l2*cos(q2)*sin(q1), 0, 0, 0, 0;
            -l2*sin(q1)*sin(q2),  l2*cos(q1)*cos(q2), 0, 0, 0, 0;
                              0,         -l2*sin(q2), 0, 0, 0, 0;
                              0,            -cos(q1), 0, 0, 0, 0;
                              0,            -sin(q1), 0, 0, 0, 0;
                              1,                   0, 0, 0, 0, 0];
               
    
    J_3 = [ -(cos(q1)*(l3*sin(q2 + q3) + 2*l2*sin(q2) - 3^(1/2)*l3*cos(q2 + q3)))/2, -sin(q1)*((l3*cos(q2 + q3))/2 + l2*cos(q2) + (3^(1/2)*l3*sin(q2 + q3))/2), -l3*sin(q2 + q3 + pi/6)*sin(q1), 0, 0, 0;
            -(sin(q1)*(l3*sin(q2 + q3) + 2*l2*sin(q2) - 3^(1/2)*l3*cos(q2 + q3)))/2,  cos(q1)*((l3*cos(q2 + q3))/2 + l2*cos(q2) + (3^(1/2)*l3*sin(q2 + q3))/2),  l3*sin(q2 + q3 + pi/6)*cos(q1), 0, 0, 0;
                                                                                  0,            (3^(1/2)*l3*cos(q2 + q3))/2 - l2*sin(q2) - (l3*sin(q2 + q3))/2,          l3*cos(q2 + q3 + pi/6), 0, 0, 0;
                                                                                  0,                                                                  -cos(q1),                        -cos(q1), 0, 0, 0;
                                                                                  0,                                                                  -sin(q1),                        -sin(q1), 0, 0, 0;
                                                                                  1,                                                                         0,                               0, 0, 0, 0];
   
    J_4 =[ cos(q1)*((l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2), -sin(q1)*((l3*cos(q2 + q3))/2 + (l4*sin(q2 + q3))/2 + l2*cos(q2) - (3^(1/2)*l4*cos(q2 + q3))/2 + (3^(1/2)*l3*sin(q2 + q3))/2), -sin(q1)*((l3*cos(q2 + q3))/2 + (l4*sin(q2 + q3))/2 - (3^(1/2)*l4*cos(q2 + q3))/2 + (3^(1/2)*l3*sin(q2 + q3))/2),                                                       0, 0, 0;
           sin(q1)*((l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2),  cos(q1)*((l3*cos(q2 + q3))/2 + (l4*sin(q2 + q3))/2 + l2*cos(q2) - (3^(1/2)*l4*cos(q2 + q3))/2 + (3^(1/2)*l3*sin(q2 + q3))/2),  cos(q1)*((l3*cos(q2 + q3))/2 + (l4*sin(q2 + q3))/2 - (3^(1/2)*l4*cos(q2 + q3))/2 + (3^(1/2)*l3*sin(q2 + q3))/2),                                                       0, 0, 0;
                                                                                                                                      0,            (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,            (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,                                                       0, 0, 0;
                                                                                                                                      0,                                                                                                                      -cos(q1),                                                                                                         -cos(q1), cos(q1 + q2 + q3 + pi/6)/2 - cos(q2 - q1 + q3 + pi/6)/2, 0, 0;
                                                                                                                                      0,                                                                                                                      -sin(q1),                                                                                                         -sin(q1), cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2, 0, 0;
                                                                                                                                      1,                                                                                                                             0,                                                                                                                0,                                     cos(q2 + q3 + pi/6), 0, 0];
 
    J_5 =[ l5*cos(q4)*sin(q1) - l2*cos(q1)*sin(q2) + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) + l4*cos(q1)*cos(q2)*sin(q3 + pi/6) + l4*cos(q1)*cos(q3 + pi/6)*sin(q2) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6) + l5*cos(q1)*cos(q2)*cos(q3 + pi/6)*sin(q4) - l5*cos(q1)*sin(q2)*sin(q4)*sin(q3 + pi/6),                                  -sin(q1)*(l2*cos(q2) - l4*cos(q2)*cos(q3 + pi/6) + l3*cos(q2)*sin(q3 + pi/6) + l3*cos(q3 + pi/6)*sin(q2) + l4*sin(q2)*sin(q3 + pi/6) + l5*cos(q2)*sin(q4)*sin(q3 + pi/6) + l5*cos(q3 + pi/6)*sin(q2)*sin(q4)),                                  -sin(q1)*(l3*cos(q2)*sin(q3 + pi/6) - l4*cos(q2)*cos(q3 + pi/6) + l3*cos(q3 + pi/6)*sin(q2) + l4*sin(q2)*sin(q3 + pi/6) + l5*cos(q2)*sin(q4)*sin(q3 + pi/6) + l5*cos(q3 + pi/6)*sin(q2)*sin(q4)), -(l5*(cos(q2)*cos(q4)*sin(q1)*sin(q3) - 2*cos(q1)*sin(q4) + cos(q3)*cos(q4)*sin(q1)*sin(q2) - 3^(1/2)*cos(q2)*cos(q3)*cos(q4)*sin(q1) + 3^(1/2)*cos(q4)*sin(q1)*sin(q2)*sin(q3)))/2,                                                                                                                                                                                       0, 0;
           l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l2*sin(q1)*sin(q2) - l5*cos(q1)*cos(q4) + l4*cos(q2)*sin(q1)*sin(q3 + pi/6) + l4*cos(q3 + pi/6)*sin(q1)*sin(q2) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6) + l5*cos(q2)*cos(q3 + pi/6)*sin(q1)*sin(q4) - l5*sin(q1)*sin(q2)*sin(q4)*sin(q3 + pi/6),                                   cos(q1)*(l2*cos(q2) - l4*cos(q2)*cos(q3 + pi/6) + l3*cos(q2)*sin(q3 + pi/6) + l3*cos(q3 + pi/6)*sin(q2) + l4*sin(q2)*sin(q3 + pi/6) + l5*cos(q2)*sin(q4)*sin(q3 + pi/6) + l5*cos(q3 + pi/6)*sin(q2)*sin(q4)),                                   cos(q1)*(l3*cos(q2)*sin(q3 + pi/6) - l4*cos(q2)*cos(q3 + pi/6) + l3*cos(q3 + pi/6)*sin(q2) + l4*sin(q2)*sin(q3 + pi/6) + l5*cos(q2)*sin(q4)*sin(q3 + pi/6) + l5*cos(q3 + pi/6)*sin(q2)*sin(q4)),  (l5*(2*sin(q1)*sin(q4) + cos(q1)*cos(q2)*cos(q4)*sin(q3) + cos(q1)*cos(q3)*cos(q4)*sin(q2) - 3^(1/2)*cos(q1)*cos(q2)*cos(q3)*cos(q4) + 3^(1/2)*cos(q1)*cos(q4)*sin(q2)*sin(q3)))/2,                                                                                                                                                                                       0, 0;
                                                                                                                                                                                                                                                                                         0, (l4*cos(q2 + q3))/2 - (l5*cos(q2 + q3 - q4))/4 - (l3*sin(q2 + q3))/2 - l2*sin(q2) + (l5*cos(q2 + q3 + q4))/4 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, (l4*cos(q2 + q3))/2 - (l5*cos(q2 + q3 - q4))/4 - (l3*sin(q2 + q3))/2 + (l5*cos(q2 + q3 + q4))/4 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,                                                                                                                                                      l5*sin(q2 + q3 + pi/6)*cos(q4),                                                                                                                                                                                       0, 0;
                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                       -cos(q1),                                                                                                                                                                                                                          -cos(q1),                                                                                                                             cos(q1 + q2 + q3 + pi/6)/2 - cos(q2 - q1 + q3 + pi/6)/2, (3^(1/2)*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 - cos(q1)*cos(q4) - (3^(1/2)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2, 0;
                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                       -sin(q1),                                                                                                                                                                                                                          -sin(q1),                                                                                                                             cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2, (cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - cos(q4)*sin(q1) + (cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 + (3^(1/2)*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2, 0;
                                                                                                                                                                                                                                                                                         1,                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                 0,                                                                                                                                                                 cos(q2 + q3 + pi/6),                                                                                                                                                             sin(q2 + q3 + pi/6)*sin(q4), 0];
                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                     
    J_6 = [ l4*(cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2) - l5*((cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - cos(q4)*sin(q1) + (cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 + (3^(1/2)*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2) + l6*(cos(q5 + pi/3)*(sin(q1)*sin(q4) + (cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2) + sin(q5 + pi/3)*(cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2)) - l2*cos(q1)*sin(q2) + l3*cos(q1)*cos(q2)*cos(q3 + pi/6) - l3*cos(q1)*sin(q2)*sin(q3 + pi/6),                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                     sin(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*cos(q1)*sin(q4) - (l6*cos(q1)*cos(q4)*cos(q5))/2 - (l5*cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - (l5*cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 + (3^(1/2)*l6*cos(q1)*cos(q4)*sin(q5))/2 - (3*l6*cos(q2)*cos(q3)*sin(q1)*sin(q4)*sin(q5))/4 - (l6*cos(q2)*cos(q5)*sin(q1)*sin(q3)*sin(q4))/4 - (l6*cos(q3)*cos(q5)*sin(q1)*sin(q2)*sin(q4))/4 + (3*l6*sin(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l5*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 - (3^(1/2)*l5*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2 + (3^(1/2)*l6*cos(q2)*cos(q3)*cos(q5)*sin(q1)*sin(q4))/4 + (3^(1/2)*l6*cos(q2)*sin(q1)*sin(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q3)*sin(q1)*sin(q2)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q5)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/4, l6*cos(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q2)*cos(q4)*cos(q3 + pi/6)*sin(q1)*sin(q5 + pi/3) - l6*cos(q4)*sin(q1)*sin(q2)*sin(q5 + pi/3)*sin(q3 + pi/6) + l6*cos(q2)*cos(q4)^2*cos(q5 + pi/3)*sin(q1)*sin(q3 + pi/6) + l6*cos(q4)^2*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q1)*sin(q2) + l6*cos(q2)*cos(q5 + pi/3)*sin(q1)*sin(q4)^2*sin(q3 + pi/6) + l6*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q1)*sin(q2)*sin(q4)^2 + l6*cos(q1)*cos(q2)^2*cos(q3 + pi/6)^2*sin(q4)*sin(q5 + pi/3) + l6*cos(q1)*cos(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q1)*cos(q3 + pi/6)^2*sin(q2)^2*sin(q4)*sin(q5 + pi/3),                                                                                                                                                                                                                                                                                     0;
            l6*(sin(q5 + pi/3)*(cos(q2 - q1 + q3 + pi/6)/2 - cos(q1 + q2 + q3 + pi/6)/2) + cos(q5 + pi/3)*((cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - cos(q1)*sin(q4) + (cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 - (3^(1/2)*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 + (3^(1/2)*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2)) - l5*(cos(q1)*cos(q4) + (cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 + (cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 - (3^(1/2)*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 + (3^(1/2)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2) + l4*(cos(q2 - q1 + q3 + pi/6)/2 - cos(q1 + q2 + q3 + pi/6)/2) - l2*sin(q1)*sin(q2) + l3*cos(q2)*cos(q3 + pi/6)*sin(q1) - l3*sin(q1)*sin(q2)*sin(q3 + pi/6),                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) - l2*cos(q2) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)),                                                                                                                                                                                                                                                                                                    -cos(q1)*(l4*cos(q2 + q3 + pi/6) + (l6*cos(q2 + q3 + q5))/2 + (l6*cos(q2 + q3 - q5 + pi/3))/2 - l5*sin(q2 + q3 + pi/6)*sin(q4) - l3*cos(q2)*sin(q3 + pi/6) - l3*cos(q3 + pi/6)*sin(q2) + l6*sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)), l5*sin(q1)*sin(q4) - (l6*cos(q4)*cos(q5)*sin(q1))/2 + (l5*cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (l5*cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 + (3^(1/2)*l6*cos(q4)*sin(q1)*sin(q5))/2 + (3*l6*cos(q1)*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (l6*cos(q1)*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (l6*cos(q1)*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 - (3*l6*cos(q1)*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l5*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*l5*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2 - (3^(1/2)*l6*cos(q1)*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3^(1/2)*l6*cos(q1)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3^(1/2)*l6*cos(q1)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q1)*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4, l6*cos(q2)^2*sin(q1)*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 + l6*cos(q3 + pi/6)^2*sin(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3) + l6*sin(q1)*sin(q2)^2*sin(q4)*sin(q5 + pi/3)*sin(q3 + pi/6)^2 - l6*cos(q1)*cos(q2)*cos(q4)*cos(q3 + pi/6)*sin(q5 + pi/3) + l6*cos(q1)*cos(q4)*sin(q2)*sin(q5 + pi/3)*sin(q3 + pi/6) - l6*cos(q1)*cos(q2)*cos(q4)^2*cos(q5 + pi/3)*sin(q3 + pi/6) - l6*cos(q1)*cos(q4)^2*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q2) - l6*cos(q1)*cos(q2)*cos(q5 + pi/3)*sin(q4)^2*sin(q3 + pi/6) - l6*cos(q1)*cos(q5 + pi/3)*cos(q3 + pi/6)*sin(q2)*sin(q4)^2 + l6*cos(q2)^2*cos(q3 + pi/6)^2*sin(q1)*sin(q4)*sin(q5 + pi/3),                                                                                                                                                                                                                                                                                     0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - l2*sin(q2) - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2, (l6*sin(q2 + q3 - q5))/4 - (l5*cos(q2 + q3 - q4))/4 - (l6*sin(q2 + q3 - q4 - q5))/8 + (l6*sin(q2 + q3 + q4 + q5))/4 + (l4*cos(q2 + q3))/2 - (l3*sin(q2 + q3))/2 - (l6*sin(q2 + q3 + q4 - q5))/8 + (l6*sin(q2 + q3 - q4 + q5))/4 + (l5*cos(q2 + q3 + q4))/4 + (l6*sin(q2 + q3 + q5))/2 - (3^(1/2)*l6*cos(q2 + q3 + q4 - q5))/8 + (3^(1/2)*l5*sin(q2 + q3 + q4))/4 - (3^(1/2)*l6*cos(q2 + q3 - q4 - q5))/8 + (3^(1/2)*l6*cos(q2 + q3 - q5))/4 - (3^(1/2)*l5*sin(q2 + q3 - q4))/4 + (3^(1/2)*l3*cos(q2 + q3))/2 + (3^(1/2)*l4*sin(q2 + q3))/2,                                                                                                                                                                                                (l5*cos(q2)*cos(q3)*cos(q4))/2 - (l5*cos(q4)*sin(q2)*sin(q3))/2 + (l6*cos(q2)*cos(q3)*cos(q5)*sin(q4))/4 - (3*l6*cos(q2)*sin(q3)*sin(q4)*sin(q5))/4 - (3*l6*cos(q3)*sin(q2)*sin(q4)*sin(q5))/4 - (l6*cos(q5)*sin(q2)*sin(q3)*sin(q4))/4 + (3^(1/2)*l5*cos(q2)*cos(q4)*sin(q3))/2 + (3^(1/2)*l5*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*l6*cos(q2)*cos(q3)*sin(q4)*sin(q5))/4 + (3^(1/2)*l6*cos(q2)*cos(q5)*sin(q3)*sin(q4))/4 + (3^(1/2)*l6*cos(q3)*cos(q5)*sin(q2)*sin(q4))/4 + (3^(1/2)*l6*sin(q2)*sin(q3)*sin(q4)*sin(q5))/4,                                                                                                                                                                                                                                                                                                                                                                                                                                                 (l6*(4*sin(q2 + q3 + q5) - 4*sin(q2 + q3 - q5 + pi/3) + 2*sin(q2 + q3 + q4 + q5) + 2*sin(q2 + q3 + q4 - q5 + pi/3) + 2*cos(q4 - q3 - q2 + q5 + pi/6) + 2*sin(q2 + q3 - q4 + q5)))/8,                                                                                                                                                                                                                                                                                     0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -cos(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 + q2 + q3 + pi/6)/2 - cos(q2 - q1 + q3 + pi/6)/2,                                                                                                                                                                                                                                                                                                                                                                                                                                             (3^(1/2)*cos(q2)*cos(q3)*sin(q1)*sin(q4))/2 - (cos(q2)*sin(q1)*sin(q3)*sin(q4))/2 - (cos(q3)*sin(q1)*sin(q2)*sin(q4))/2 - cos(q1)*cos(q4) - (3^(1/2)*sin(q1)*sin(q2)*sin(q3)*sin(q4))/2, - sin(q5 + pi/3)*(cos(q2 - q1 + q3 + pi/6)/2 - cos(q1 + q2 + q3 + pi/6)/2) - cos(q5 + pi/3)*((cos(q2)*cos(q4)*sin(q1)*sin(q3))/2 - cos(q1)*sin(q4) + (cos(q3)*cos(q4)*sin(q1)*sin(q2))/2 - (3^(1/2)*cos(q2)*cos(q3)*cos(q4)*sin(q1))/2 + (3^(1/2)*cos(q4)*sin(q1)*sin(q2)*sin(q3))/2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   -sin(q1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2,                                                                                                                                                                                                                                                                                                                                                                                                                                             (cos(q1)*cos(q2)*sin(q3)*sin(q4))/2 - cos(q4)*sin(q1) + (cos(q1)*cos(q3)*sin(q2)*sin(q4))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*sin(q4))/2 + (3^(1/2)*cos(q1)*sin(q2)*sin(q3)*sin(q4))/2,   cos(q5 + pi/3)*(sin(q1)*sin(q4) + (cos(q1)*cos(q2)*cos(q4)*sin(q3))/2 + (cos(q1)*cos(q3)*cos(q4)*sin(q2))/2 - (3^(1/2)*cos(q1)*cos(q2)*cos(q3)*cos(q4))/2 + (3^(1/2)*cos(q1)*cos(q4)*sin(q2)*sin(q3))/2) + sin(q5 + pi/3)*(cos(q1 - q2 - q3 + pi/3)/2 + cos(q1 + q2 + q3 - pi/3)/2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cos(q2 + q3 + pi/6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sin(q2 + q3 + pi/6)*sin(q4),                                                                                                                                                                                         cos(q2 + q3 + q5)/2 + cos(q2 + q3 - q5 + pi/3)/2 + sin(q2 + q3 + pi/6)*cos(q4)*cos(q5 + pi/3)];                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
    J = zeros(6,6,6);
    J(:,:,1) = J_1;
    J(:,:,2) = J_2;
    J(:,:,3) = J_3;
    J(:,:,4) = J_4;
    J(:,:,5) = J_5;
    J(:,:,6) = J_6;
    
    %% Rotation Matrix in each Frames rpt Frame0
    R_1 = [ cos(q1 - pi/2), 0,  sin(q1 - pi/2) ;
            sin(q1 - pi/2), 0, -cos(q1 - pi/2) ;
                         0, 1,               0 ];
    R_2 = [ cos(q1 - pi/2)*cos(q2 + pi/2), -cos(q1 - pi/2)*sin(q2 + pi/2),  sin(q1 - pi/2) ;
            cos(q2 + pi/2)*sin(q1 - pi/2), -sin(q1 - pi/2)*sin(q2 + pi/2), -cos(q1 - pi/2) ;
                           sin(q2 + pi/2),                 cos(q2 + pi/2),               0 ];
    R_3 = [ cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3), -sin(q1 - pi/2), - cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) - cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2) ;
            cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3),  cos(q1 - pi/2), - cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) - cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2) ;
                                          cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2),               0,                                 cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3) ];
    R_4 = [ cos(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)) - sin(q4)*sin(q1 - pi/2), - cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) - cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2), cos(q4)*sin(q1 - pi/2) + sin(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)) ;
            cos(q1 - pi/2)*sin(q4) + cos(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)), - cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) - cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2), sin(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)) - cos(q4)*cos(q1 - pi/2) ;
                                                                   cos(q4)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)),                                 cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3),                                                        sin(q4)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)) ];
    R_5 = [ - cos(q5 - pi/6)*(sin(q4)*sin(q1 - pi/2) - cos(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) - sin(q5 - pi/6)*(cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2)), - cos(q4)*sin(q1 - pi/2) - sin(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)),   sin(q5 - pi/6)*(sin(q4)*sin(q1 - pi/2) - cos(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) - cos(q5 - pi/6)*(cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2)) ;
              cos(q5 - pi/6)*(cos(q1 - pi/2)*sin(q4) + cos(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) - sin(q5 - pi/6)*(cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2)),   cos(q4)*cos(q1 - pi/2) - sin(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)), - sin(q5 - pi/6)*(cos(q1 - pi/2)*sin(q4) + cos(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) - cos(q5 - pi/6)*(cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2)) ;
                                                                                                     sin(q5 - pi/6)*(cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3)) + cos(q4)*cos(q5 - pi/6)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)),                                                         -sin(q4)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)),                                                                                          cos(q5 - pi/6)*(cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3)) - cos(q4)*sin(q5 - pi/6)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)) ];
    R_6 = [ - cos(q6)*(cos(q5 - pi/6)*(sin(q4)*sin(q1 - pi/2) - cos(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) + sin(q5 - pi/6)*(cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2))) - sin(q6)*(cos(q4)*sin(q1 - pi/2) + sin(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))),   cos(q6)*(cos(q4)*sin(q1 - pi/2) + sin(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) - sin(q6)*(cos(q5 - pi/6)*(sin(q4)*sin(q1 - pi/2) - cos(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) + sin(q5 - pi/6)*(cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2))), cos(q5 - pi/6)*(cos(q1 - pi/2)*cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q1 - pi/2)*cos(q3 - pi/3)*sin(q2 + pi/2)) - sin(q5 - pi/6)*(sin(q4)*sin(q1 - pi/2) - cos(q4)*(cos(q1 - pi/2)*cos(q2 + pi/2)*cos(q3 - pi/3) - cos(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) ;
              sin(q6)*(cos(q4)*cos(q1 - pi/2) - sin(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) - cos(q6)*(sin(q5 - pi/6)*(cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2)) - cos(q5 - pi/6)*(cos(q1 - pi/2)*sin(q4) + cos(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)))), - sin(q6)*(sin(q5 - pi/6)*(cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2)) - cos(q5 - pi/6)*(cos(q1 - pi/2)*sin(q4) + cos(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3)))) - cos(q6)*(cos(q4)*cos(q1 - pi/2) - sin(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))), sin(q5 - pi/6)*(cos(q1 - pi/2)*sin(q4) + cos(q4)*(cos(q2 + pi/2)*cos(q3 - pi/3)*sin(q1 - pi/2) - sin(q1 - pi/2)*sin(q2 + pi/2)*sin(q3 - pi/3))) + cos(q5 - pi/6)*(cos(q2 + pi/2)*sin(q1 - pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q1 - pi/2)*sin(q2 + pi/2)) ;
                                                                                                                                                              cos(q6)*(sin(q5 - pi/6)*(cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3)) + cos(q4)*cos(q5 - pi/6)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2))) - sin(q4)*sin(q6)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)),                                                                                                                                                   sin(q6)*(sin(q5 - pi/6)*(cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3)) + cos(q4)*cos(q5 - pi/6)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2))) + cos(q6)*sin(q4)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)),                                                                                        cos(q4)*sin(q5 - pi/6)*(cos(q2 + pi/2)*sin(q3 - pi/3) + cos(q3 - pi/3)*sin(q2 + pi/2)) - cos(q5 - pi/6)*(cos(q2 + pi/2)*cos(q3 - pi/3) - sin(q2 + pi/2)*sin(q3 - pi/3)) ];                                                                                                                                          
    R = zeros(3,3,6);
    R(:,:,1) = R_1;
    R(:,:,2) = R_2;
    R(:,:,3) = R_3;
    R(:,:,4) = R_4;
    R(:,:,5) = R_5;
    R(:,:,6) = R_6;
    
    %% Calculate Torque
    T = zeros(6,1);
    for i = 1:6
        F_i = [F(:,i) ; cross(R(:,:,i)*CM(:,i),F(:,i))];
        T =  T + J(:,:,i).'*F_i;
    end
    
    T = T + J(:,:,6).'*Fn;
    T = T./1000;
    
end
